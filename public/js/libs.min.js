/*
 * store.js
 * Copyright (c) 2010-2011 Marcus Westin
 */
var store=function(){var b={},e=window,g=e.document,c;b.disabled=false;b.set=function(){};b.get=function(){};b.remove=function(){};b.clear=function(){};b.transact=function(a,d){var f=b.get(a);if(typeof f=="undefined")f={};d(f);b.set(a,f)};b.serialize=function(a){return JSON.stringify(a)};b.deserialize=function(a){if(typeof a=="string")return JSON.parse(a)};var h;try{h="localStorage"in e&&e.localStorage}catch(k){h=false}if(h){c=e.localStorage;b.set=function(a,d){c.setItem(a,b.serialize(d))};b.get=function(a){return b.deserialize(c.getItem(a))};b.remove=function(a){c.removeItem(a)};b.clear=function(){c.clear()}}else{var i;try{i="globalStorage"in e&&e.globalStorage&&e.globalStorage[e.location.hostname]}catch(l){i=false}if(i){c=e.globalStorage[e.location.hostname];b.set=function(a,d){c[a]=b.serialize(d)};b.get=function(a){return b.deserialize(c[a]&&c[a].value)};b.remove=function(a){delete c[a]};b.clear=function(){for(var a in c)delete c[a]}}else if(g.documentElement.addBehavior){c=g.createElement("div");e=function(a){return function(){var d=Array.prototype.slice.call(arguments,0);d.unshift(c);g.body.appendChild(c);c.addBehavior("#default#userData");c.load("localStorage");d=a.apply(b,d);g.body.removeChild(c);return d}};b.set=e(function(a,d,f){a.setAttribute(d,b.serialize(f));a.save("localStorage")});b.get=e(function(a,d){return b.deserialize(a.getAttribute(d))});b.remove=e(function(a,d){a.removeAttribute(d);a.save("localStorage")});b.clear=e(function(a){var d=a.XMLDocument.documentElement.attributes;a.load("localStorage");for(var f=0,j;j=d[f];f++)a.removeAttribute(j.name);a.save("localStorage")})}}try{b.set("__storejs__","__storejs__");if(b.get("__storejs__")!="__storejs__")b.disabled=true;b.remove("__storejs__")}catch(m){b.disabled=true}return b}();
/*
 * twitter-text-js 1.4.5
 *
 * Copyright 2010 Twitter, Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */
if(!window.twttr){window.twttr={}}(function(){twttr.txt={};twttr.txt.regexen={};var c={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};twttr.txt.htmlEscape=function(r){return r&&r.replace(/[&"'><]/g,function(s){return c[s]})};function d(s,r){r=r||"";if(typeof s!=="string"){if(s.global&&r.indexOf("g")<0){r+="g"}if(s.ignoreCase&&r.indexOf("i")<0){r+="i"}if(s.multiline&&r.indexOf("m")<0){r+="m"}s=s.source}return new RegExp(s.replace(/#\{(\w+)\}/g,function(u,t){var v=twttr.txt.regexen[t]||"";if(typeof v!=="string"){v=v.source}return v}),r)}function e(s,r){return s.replace(/#\{(\w+)\}/g,function(u,t){return r[t]||""})}function b(t,v,r){var u=String.fromCharCode(v);if(r!==v){u+="-"+String.fromCharCode(r)}t.push(u);return t}var j=String.fromCharCode;var h=[j(32),j(133),j(160),j(5760),j(6158),j(8232),j(8233),j(8239),j(8287),j(12288)];b(h,9,13);b(h,8192,8202);twttr.txt.regexen.spaces_group=d(h.join(""));twttr.txt.regexen.spaces=d("["+h.join("")+"]");twttr.txt.regexen.punct=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~/;twttr.txt.regexen.atSigns=/[@���]/;twttr.txt.regexen.extractMentions=d(/(^|[^a-zA-Z0-9_])(#{atSigns})([a-zA-Z0-9_]{1,20})(?=(.|$))/g);twttr.txt.regexen.extractReply=d(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/);twttr.txt.regexen.listName=/[a-zA-Z][a-zA-Z0-9_\-\u0080-\u00ff]{0,24}/;var n=[];b(n,1024,1279);b(n,1280,1319);b(n,4352,4607);b(n,12592,12677);b(n,43360,43391);b(n,44032,55215);b(n,55216,55295);b(n,12449,12538);b(n,12540,12540);b(n,65382,65439);b(n,65392,65392);b(n,65296,65305);b(n,65313,65338);b(n,65345,65370);b(n,12353,12438);b(n,13312,19903);b(n,19968,40959);b(n,173824,177983);b(n,177984,178207);b(n,194560,195103);b(n,12293,12293);twttr.txt.regexen.nonLatinHashtagChars=d(n.join(""));twttr.txt.regexen.latinAccentChars=d("����������������������������������������������������������������������������������������������������������������������\\303\\277");twttr.txt.regexen.latenAccents=d(/[#{latinAccentChars}]+/);twttr.txt.regexen.endScreenNameMatch=d(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/);twttr.txt.regexen.hashtagBoundary=d(/(?:^|$|#{spaces}|���|���|���|���|\.|!|���|\?|���|,)/);twttr.txt.regexen.hashtagAlpha=d(/[a-z_#{latinAccentChars}#{nonLatinHashtagChars}]/i);twttr.txt.regexen.hashtagAlphaNumeric=d(/[a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}]/i);twttr.txt.regexen.autoLinkHashtags=d(/(#{hashtagBoundary})(#|���)(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi);twttr.txt.regexen.autoLinkUsernamesOrLists=/(^|[^a-zA-Z0-9_]|RT:?)([@���]+)([a-zA-Z0-9_]{1,20})(\/[a-zA-Z][a-zA-Z0-9_\-]{0,24})?/g;twttr.txt.regexen.autoLinkEmoticon=/(8\-\#|8\-E|\+\-\(|\`\@|\`O|\&lt;\|:~\(|\}:o\{|:\-\[|\&gt;o\&lt;|X\-\/|\[:-\]\-I\-|\/\/\/\/��\\\\\\\\|\(\|:\|\/\)|���:\*\)|\( \| \))/g;twttr.txt.regexen.invalidDomainChars=e("\u00A0#{punct}#{spaces_group}",twttr.txt.regexen);twttr.txt.regexen.validPrecedingChars=d(/(?:[^-\/"':!=A-Za-z0-9_@���]|^|\:)/);twttr.txt.regexen.validSubdomain=d(/(?:[^#{invalidDomainChars}](?:[_-]|[^#{invalidDomainChars}])*)?[^#{invalidDomainChars}]\./);twttr.txt.regexen.validDomainName=d(/(?:[^#{invalidDomainChars}](?:[-]|[^#{invalidDomainChars}])*)?[^#{invalidDomainChars}]/);twttr.txt.regexen.validDomain=d(/(#{validSubdomain})*#{validDomainName}\.(?:xn--[a-z0-9]{2,}|[a-z]{2,})(?::[0-9]+)?/i);twttr.txt.regexen.validGeneralUrlPathChars=/[a-z0-9!\*';:=\+\$\/%#\[\]\-_,~|\.]/i;twttr.txt.regexen.wikipediaDisambiguation=d(/(?:\(#{validGeneralUrlPathChars}+\))/i);twttr.txt.regexen.validUrlPathChars=d(/(?:#{wikipediaDisambiguation}|@#{validGeneralUrlPathChars}+\/|[\.,]?#{validGeneralUrlPathChars})/i);twttr.txt.regexen.validUrlPathEndingChars=d(/(?:[\+\-a-z0-9=_#\/]|#{wikipediaDisambiguation})/i);twttr.txt.regexen.validUrlQueryChars=/[a-z0-9!\*'\(\);:&=\+\$\/%#\[\]\-_\.,~|]/i;twttr.txt.regexen.validUrlQueryEndingChars=/[a-z0-9_&=#\/]/i;twttr.txt.regexen.extractUrl=d("((#{validPrecedingChars})((https?:\\/\\/)(#{validDomain})(\\/(?:#{validUrlPathChars}+#{validUrlPathEndingChars}|#{validUrlPathChars}+#{validUrlPathEndingChars}?|#{validUrlPathEndingChars})?)?(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?))","gi");twttr.txt.regexen.validateUrlUnreserved=/[a-z0-9\-._~]/i;twttr.txt.regexen.validateUrlPctEncoded=/(?:%[0-9a-f]{2})/i;twttr.txt.regexen.validateUrlSubDelims=/[!$&'()*+,;=]/i;twttr.txt.regexen.validateUrlPchar=d("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|:|@)","i");twttr.txt.regexen.validateUrlScheme=/(?:[a-z][a-z0-9+\-.]*)/i;twttr.txt.regexen.validateUrlUserinfo=d("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|:)*","i");twttr.txt.regexen.validateUrlDecOctet=/(?:[0-9]|(?:[1-9][0-9])|(?:1[0-9]{2})|(?:2[0-4][0-9])|(?:25[0-5]))/i;twttr.txt.regexen.validateUrlIpv4=d(/(?:#{validateUrlDecOctet}(?:\.#{validateUrlDecOctet}){3})/i);twttr.txt.regexen.validateUrlIpv6=/(?:\[[a-f0-9:\.]+\])/i;twttr.txt.regexen.validateUrlIp=d("(?:#{validateUrlIpv4}|#{validateUrlIpv6})","i");twttr.txt.regexen.validateUrlSubDomainSegment=/(?:[a-z0-9](?:[a-z0-9_\-]*[a-z0-9])?)/i;twttr.txt.regexen.validateUrlDomainSegment=/(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)/i;twttr.txt.regexen.validateUrlDomainTld=/(?:[a-z](?:[a-z0-9\-]*[a-z0-9])?)/i;twttr.txt.regexen.validateUrlDomain=d(/(?:(?:#{validateUrlSubDomainSegment]}\.)*(?:#{validateUrlDomainSegment]}\.)#{validateUrlDomainTld})/i);twttr.txt.regexen.validateUrlHost=d("(?:#{validateUrlIp}|#{validateUrlDomain})","i");twttr.txt.regexen.validateUrlUnicodeSubDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9_\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i;twttr.txt.regexen.validateUrlUnicodeDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i;twttr.txt.regexen.validateUrlUnicodeDomainTld=/(?:(?:[a-z]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i;twttr.txt.regexen.validateUrlUnicodeDomain=d(/(?:(?:#{validateUrlUnicodeSubDomainSegment}\.)*(?:#{validateUrlUnicodeDomainSegment}\.)#{validateUrlUnicodeDomainTld})/i);twttr.txt.regexen.validateUrlUnicodeHost=d("(?:#{validateUrlIp}|#{validateUrlUnicodeDomain})","i");twttr.txt.regexen.validateUrlPort=/[0-9]{1,5}/;twttr.txt.regexen.validateUrlUnicodeAuthority=d("(?:(#{validateUrlUserinfo})@)?(#{validateUrlUnicodeHost})(?::(#{validateUrlPort}))?","i");twttr.txt.regexen.validateUrlAuthority=d("(?:(#{validateUrlUserinfo})@)?(#{validateUrlHost})(?::(#{validateUrlPort}))?","i");twttr.txt.regexen.validateUrlPath=d(/(\/#{validateUrlPchar}*)*/i);twttr.txt.regexen.validateUrlQuery=d(/(#{validateUrlPchar}|\/|\?)*/i);twttr.txt.regexen.validateUrlFragment=d(/(#{validateUrlPchar}|\/|\?)*/i);twttr.txt.regexen.validateUrlUnencoded=d("^(?:([^:/?#]+):)(?://([^/?#]*))([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$","i");var a="tweet-url";var g="list-slug";var q="username";var m="hashtag";var o=' rel="nofollow"';function k(u){var t={};for(var s in u){if(u.hasOwnProperty(s)){t[s]=u[s]}}return t}twttr.txt.autoLink=function(s,r){r=k(r||{});return twttr.txt.autoLinkUsernamesOrLists(twttr.txt.autoLinkUrlsCustom(twttr.txt.autoLinkHashtags(s,r),r),r)};twttr.txt.autoLinkUsernamesOrLists=function(x,v){v=k(v||{});v.urlClass=v.urlClass||a;v.listClass=v.listClass||g;v.usernameClass=v.usernameClass||q;v.usernameUrlBase=v.usernameUrlBase||"http://twitter.com/";v.listUrlBase=v.listUrlBase||"http://twitter.com/";if(!v.suppressNoFollow){var r=o}var w="",u=twttr.txt.splitTags(x);for(var t=0;t<u.length;t++){var s=u[t];if(t!==0){w+=((t%2===0)?">":"<")}if(t%4!==0){w+=s}else{w+=s.replace(twttr.txt.regexen.autoLinkUsernamesOrLists,function(E,H,A,D,y,C,I){var z=I.slice(C+E.length);var G={before:H,at:A,user:twttr.txt.htmlEscape(D),slashListname:twttr.txt.htmlEscape(y),extraHtml:r,preChunk:"",chunk:twttr.txt.htmlEscape(I),postChunk:""};for(var B in v){if(v.hasOwnProperty(B)){G[B]=v[B]}}if(y&&!v.suppressLists){var F=G.chunk=e("#{user}#{slashListname}",G);G.list=twttr.txt.htmlEscape(F.toLowerCase());return e('#{before}#{at}<a class="#{urlClass} #{listClass}" target="_blank" href="#{listUrlBase}#{list}"#{extraHtml}>#{chunk}</a>',G)}else{if(z&&z.match(twttr.txt.regexen.endScreenNameMatch)){return E}else{G.chunk=twttr.txt.htmlEscape(D);G.dataScreenName=!v.suppressDataScreenName?e('data-screen-name="#{chunk}" ',G):"";return e('#{before}#{at}<a class="#{urlClass} #{usernameClass}" target="_blank" #{dataScreenName}href="#{usernameUrlBase}#{chunk}"#{extraHtml}>#{preChunk}#{chunk}#{postChunk}</a>',G)}}})}}return w};twttr.txt.autoLinkHashtags=function(t,s){s=k(s||{});s.urlClass=s.urlClass||a;s.hashtagClass=s.hashtagClass||m;s.hashtagUrlBase=s.hashtagUrlBase||"http://twitter.com/search?q=%23";if(!s.suppressNoFollow){var r=o}return t.replace(twttr.txt.regexen.autoLinkHashtags,function(v,w,x,z){var y={before:w,hash:twttr.txt.htmlEscape(x),preText:"",text:twttr.txt.htmlEscape(z),postText:"",extraHtml:r};for(var u in s){if(s.hasOwnProperty(u)){y[u]=s[u]}}return e('#{before}<a target="_blank" href="#{hashtagUrlBase}#{text}" title="##{text}" class="#{urlClass} #{hashtagClass}"#{extraHtml}>#{hash}#{preText}#{text}#{postText}</a>',y)})};twttr.txt.autoLinkUrlsCustom=function(s,r){r=k(r||{});if(!r.suppressNoFollow){r.rel="nofollow"}if(r.urlClass){r["class"]=r.urlClass;delete r.urlClass}delete r.suppressNoFollow;delete r.suppressDataScreenName;return s.replace(twttr.txt.regexen.extractUrl,function(z,C,B,u,D,y,E,t){var w;if(D){var v="";for(var x in r){v+=e(' #{k}="#{v}" ',{k:x,v:r[x].toString().replace(/"/,"&quot;").replace(/</,"&lt;").replace(/>/,"&gt;")})}var A={before:B,htmlAttrs:v,url:twttr.txt.htmlEscape(u)};return e('#{before}<a target="_blank" href="#{url}"#{htmlAttrs}>#{url}</a>',A)}else{return C}})};twttr.txt.extractMentions=function(u){var v=[],r=twttr.txt.extractMentionsWithIndices(u);for(var t=0;t<r.length;t++){var s=r[t].screenName;v.push(s)}return v};twttr.txt.extractMentionsWithIndices=function(t){if(!t){return[]}var s=[],r=0;t.replace(twttr.txt.regexen.extractMentions,function(u,y,x,v,z){if(!z.match(twttr.txt.regexen.endScreenNameMatch)){var w=t.indexOf(x+v,r);r=w+v.length+1;s.push({screenName:v,indices:[w,r]})}});return s};twttr.txt.extractReplies=function(s){if(!s){return null}var r=s.match(twttr.txt.regexen.extractReply);if(!r){return null}return r[1]};twttr.txt.extractUrls=function(u){var t=[],r=twttr.txt.extractUrlsWithIndices(u);for(var s=0;s<r.length;s++){t.push(r[s].url)}return t};twttr.txt.extractUrlsWithIndices=function(t){if(!t){return[]}var s=[],r=0;t.replace(twttr.txt.regexen.extractUrl,function(z,C,B,u,D,w,E,A){var v;if(D){var x=t.indexOf(u,y),y=x+u.length;s.push({url:u,indices:[x,y]})}});return s};twttr.txt.extractHashtags=function(u){var t=[],s=twttr.txt.extractHashtagsWithIndices(u);for(var r=0;r<s.length;r++){t.push(s[r].hashtag)}return t};twttr.txt.extractHashtagsWithIndices=function(t){if(!t){return[]}var s=[],r=0;t.replace(twttr.txt.regexen.autoLinkHashtags,function(u,x,y,w){var v=t.indexOf(y+w,r);r=v+w.length+1;s.push({hashtag:w,indices:[v,r]})});return s};twttr.txt.splitTags=function(x){var r=x.split("<"),w,v=[],u;for(var t=0;t<r.length;t+=1){u=r[t];if(!u){v.push("")}else{w=u.split(">");for(var s=0;s<w.length;s+=1){v.push(w[s])}}}return v};twttr.txt.hitHighlight=function(C,E,u){var A="em";E=E||[];u=u||{};if(E.length===0){return C}var t=u.tag||A,D=["<"+t+">","</"+t+">"],B=twttr.txt.splitTags(C),F,I,H,x="",r=0,y=B[0],z=0,s=0,M=false,v=y,G=[],w,J,N,L,K;for(I=0;I<E.length;I+=1){for(H=0;H<E[I].length;H+=1){G.push(E[I][H])}}for(w=0;w<G.length;w+=1){J=G[w];N=D[w%2];L=false;while(y!=null&&J>=z+y.length){x+=v.slice(s);if(M&&J===z+v.length){x+=N;L=true}if(B[r+1]){x+="<"+B[r+1]+">"}z+=v.length;s=0;r+=2;y=B[r];v=y;M=false}if(!L&&y!=null){K=J-z;x+=v.slice(s,K)+N;s=K;if(w%2===0){M=true}else{M=false}}else{if(!L){L=true;x+=N}}}if(y!=null){if(s<v.length){x+=v.slice(s)}for(w=r+1;w<B.length;w+=1){x+=(w%2===0?B[w]:"<"+B[w]+">")}}return x};var f=140;var p=[j(65534),j(65279),j(65535),j(8234),j(8235),j(8236),j(8237),j(8238)];twttr.txt.isInvalidTweet=function(s){if(!s){return"empty"}if(s.length>f){return"too_long"}for(var r=0;r<p.length;r++){if(s.indexOf(p[r])>=0){return"invalid_characters"}}return false};twttr.txt.isValidTweetText=function(r){return !twttr.txt.isInvalidTweet(r)};twttr.txt.isValidUsername=function(s){if(!s){return false}var r=twttr.txt.extractMentions(s);return r.length===1&&r[0]===s.slice(1)};var l=d(/^#{autoLinkUsernamesOrLists}$/);twttr.txt.isValidList=function(s){var r=s.match(l);return !!(r&&r[1]==""&&r[4])};twttr.txt.isValidHashtag=function(s){if(!s){return false}var r=twttr.txt.extractHashtags(s);return r.length===1&&r[0]===s.slice(1)};twttr.txt.isValidUrl=function(u,r){if(r==null){r=true}if(!u){return false}var y=u.match(twttr.txt.regexen.validateUrlUnencoded);if(!y||y[0]!==u){return false}var s=y[1],x=y[2],w=y[3],v=y[4],t=y[5];if(!(i(s,twttr.txt.regexen.validateUrlScheme)&&s.match(/^https?$/i)&&i(w,twttr.txt.regexen.validateUrlPath)&&i(v,twttr.txt.regexen.validateUrlQuery,true)&&i(t,twttr.txt.regexen.validateUrlFragment,true))){return false}return(r&&i(x,twttr.txt.regexen.validateUrlUnicodeAuthority))||(!r&&i(x,twttr.txt.regexen.validateUrlAuthority))};function i(s,t,r){if(!r){return((typeof s==="string")&&s.match(t)&&RegExp["$&"]===s)}return(!s||(s.match(t)&&RegExp["$&"]===s))}}());
/*
 * cloneNode method that will carry over all events for us
 */
function cloneNodeWithEvents(orgNode){var orgNodeEvenets=orgNode.getElementsByTagName("*");var cloneNode=orgNode.cloneNode(true);var cloneNodeEvents=cloneNode.getElementsByTagName("*");var allEvents=new Array("onabort","onbeforecopy","onbeforecut","onbeforepaste","onblur","onchange","onclick","oncontextmenu","oncopy","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","onerror","onfocus","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onpaste","onreset","onresize","onscroll","onsearch","onselect","onselectstart","onsubmit","onunload");for(var j=0;j<allEvents.length;j++){eval("if(orgNode."+allEvents[j]+") cloneNode."+allEvents[j]+" = orgNode."+allEvents[j])}for(var i=0;i<orgNodeEvenets.length;i++){for(var j=0;j<allEvents.length;j++){eval("if(orgNodeEvenets[i]."+allEvents[j]+") cloneNodeEvents[i]."+allEvents[j]+" = orgNodeEvenets[i]."+allEvents[j])}}return cloneNode};
/*
 * display the date as xx seconds / days / etc ago
 */
function relative_time(p){var o=new Date();var m=new Date(p);if(BrowserDetect.browser=="MSIE"){m=Date.parse(p.replace(/( \+)/," UTC$1"))}var k=o-m;var j=1000;var g=j*60;var h=g*60;var n=h*24;var f=n*7;var i=n*30;var l=i*12;if(isNaN(k)||k<0||k<j*2){return translation.just_now}if(k<g){return Math.floor(k/j)+" "+translation.seconds+" "+translation.ago}if(k<g*2){return translation.minute+" "+translation.ago}if(k<h){return Math.floor(k/g)+" "+translation.minutes+" "+translation.ago}if(k<h*2){return translation.hour+" "+translation.ago}if(k<n){return Math.floor(k/h)+" "+translation.hours+" "+translation.ago}if(k>n&&k<n*2){return translation.day}if(k<f){return Math.floor(k/n)+" "+translation.days+" "+translation.ago}if(k>f&&k<f*2){return translation.week}if(k>f&&k<i){return Math.floor(k/f)+" "+translation.weeks+" "+translation.ago}if(k>i&&k<i*2){return translation.month}if(k>i&&k<l){return Math.floor(k/i)+" "+translation.months+" "+translation.ago}if(k>l&&k<l*2){return translation.year}if(k>l){return Math.floor(k/l)+" "+translation.years+" "+translation.ago}};
/*
 * Copyright (c) 2008-2009 Kevin Sylvestre (http://ksylvest.com)
 * Contributors:
 * Kevin Sylvestre (http://www.ksylvest.com)
 * Growler is freely distributable under the terms of an MIT-style license.
 */
var DEFAULT_INIT_OPTIONS={location:"bottom-right"};var DEFAULT_GROWL_OPTIONS={growl_speed:0.4,ungrowl_speed:0.4,growl_direction:{y:0,x:0},ungrowl_direction:{y:10,x:0},duration:5,opacity:0.9,color:"black",size:"medium"};function combine(a,b){a=a||{};ret=Object.clone(b);Object.extend(ret,a);return ret}function removeGrowl(b,a){if(typeof(b)==undefined){return}else{a=combine(a,DEFAULT_GROWL_OPTIONS);new Effect.Parallel([new Effect.Opacity(b,{to:0}),new Effect.Move(b,{x:a.ungrowl_direction.x,y:a.ungrowl_direction.y,mode:"relative"})],{duration:a.ungrowl_speed,afterFinish:function(){try{b.remove()}catch(c){}}});new Effect.DropOut(b,{duration:a.ungrowl_speed})}}function insertGrowl(a,d,g,i,j){if(typeof(a)==undefined){return}j=combine(j,DEFAULT_GROWL_OPTIONS);var e=new Element("div",{"class":"growl "+j.color+" "+j.size});var h=new Element("table");var f=new Element("tr");var c=new Element("td",{style:"width: 55px; margin-right: 15px;"});var b=new Element("td",{style:"width: 95%;"});c.insert(new Element("img",{src:d,style:"height: 50px; width: 50px;",alt:""}));b.insert({top:new Element("div",{"class":"title"}).update(g)});b.insert({bottom:new Element("div",{"class":"message"}).update(i)});f.insert({top:c});f.insert({bottom:b});h.insert(f);e.insert(h);e.observe("click",function(){removeGrowl(e,j)});new Element.extend(e);a.insert(e);if(j.duration){removeGrowl.delay(j.duration,e,j)}new Effect.Parallel([new Effect.Opacity(e,{to:j.opacity}),new Effect.Move(e,{x:j.growl_direction.x,y:j.growl_direction.y,mode:"relative"})],{duration:j.growl_speed})}var Growler=Class.create({initialize:function(a){a=combine(a,DEFAULT_INIT_OPTIONS);this.growls=new Element("div",{id:"growls-container","class":"growls "+a.location});this.growls.wrap(document.body)},growl:function(c,d,b,a){return insertGrowl(this.growls,c,d,b,a)},roar:function(d,c,a,b){b=combine(b,{color:a});return this.growl(d,c,b)}});
/*
 * browser detection from http://www.quirksmode.org/js/detect.html
 */
var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(d){for(var a=0;a<d.length;a++){var b=d[a].string;var c=d[a].prop;this.versionSearchString=d[a].versionSearch||d[a].identity;if(b){if(b.indexOf(d[a].subString)!=-1){return d[a].identity}}else{if(c){return d[a].identity}}}},searchVersion:function(b){var a=b.indexOf(this.versionSearchString);if(a==-1){return}return parseFloat(b.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"AppleWebKit",identity:"Webkit",},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();
/*
 * Copyright 2006 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if(!document.createElement("canvas").getContext){(function(){var v=Math;var w=v.round;var s=v.sin;var E=v.cos;var n=v.abs;var D=v.sqrt;var a=10;var o=a/2;function h(){return this.context_||(this.context_=new q(this))}var u=Array.prototype.slice;function F(j,m,G){var i=u.call(arguments,2);return function(){return j.apply(m,i.concat(u.call(arguments)))}}var k={init:function(i){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var j=i||document;j.createElement("canvas");j.attachEvent("onreadystatechange",F(this.init_,this,j))}},init_:function(H){if(!H.namespaces.g_vml_){H.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML")}if(!H.namespaces.g_o_){H.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML")}if(!H.styleSheets.ex_canvas_){var G=H.createStyleSheet();G.owningElement.id="ex_canvas_";G.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}var m=H.getElementsByTagName("canvas");for(var j=0;j<m.length;j++){this.initElement(m[j])}},initElement:function(j){if(!j.getContext){j.getContext=h;j.innerHTML="";j.attachEvent("onpropertychange",C);j.attachEvent("onresize",b);var i=j.attributes;if(i.width&&i.width.specified){j.style.width=i.width.nodeValue+"px"}else{j.width=j.clientWidth}if(i.height&&i.height.specified){j.style.height=i.height.nodeValue+"px"}else{j.height=j.clientHeight}}return j}};function C(j){var i=j.srcElement;switch(j.propertyName){case"width":i.style.width=i.attributes.width.nodeValue+"px";i.getContext().clearRect();break;case"height":i.style.height=i.attributes.height.nodeValue+"px";i.getContext().clearRect();break}}function b(j){var i=j.srcElement;if(i.firstChild){i.firstChild.style.width=i.clientWidth+"px";i.firstChild.style.height=i.clientHeight+"px"}}k.init();var e=[];for(var z=0;z<16;z++){for(var y=0;y<16;y++){e[z*16+y]=z.toString(16)+y.toString(16)}}function r(){return[[1,0,0],[0,1,0],[0,0,1]]}function d(G,m){var j=r();for(var i=0;i<3;i++){for(var J=0;J<3;J++){var H=0;for(var I=0;I<3;I++){H+=G[i][I]*m[I][J]}j[i][J]=H}}return j}function x(j,i){i.fillStyle=j.fillStyle;i.lineCap=j.lineCap;i.lineJoin=j.lineJoin;i.lineWidth=j.lineWidth;i.miterLimit=j.miterLimit;i.shadowBlur=j.shadowBlur;i.shadowColor=j.shadowColor;i.shadowOffsetX=j.shadowOffsetX;i.shadowOffsetY=j.shadowOffsetY;i.strokeStyle=j.strokeStyle;i.globalAlpha=j.globalAlpha;i.arcScaleX_=j.arcScaleX_;i.arcScaleY_=j.arcScaleY_;i.lineScale_=j.lineScale_}function c(m){var I,H=1;m=String(m);if(m.substring(0,3)=="rgb"){var K=m.indexOf("(",3);var j=m.indexOf(")",K+1);var J=m.substring(K+1,j).split(",");I="#";for(var G=0;G<3;G++){I+=e[Number(J[G])]}if(J.length==4&&m.substr(3,1)=="a"){H=J[3]}}else{I=m}return{color:I,alpha:H}}function t(i){switch(i){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function q(j){this.m_=r();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.strokeStyle="#000";this.fillStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=a*1;this.globalAlpha=1;this.canvas=j;var i=j.ownerDocument.createElement("div");i.style.width=j.clientWidth+"px";i.style.height=j.clientHeight+"px";i.style.overflow="hidden";i.style.position="absolute";j.appendChild(i);this.element_=i;this.arcScaleX_=1;this.arcScaleY_=1;this.lineScale_=1}var l=q.prototype;l.clearRect=function(){this.element_.innerHTML=""};l.beginPath=function(){this.currentPath_=[]};l.moveTo=function(j,i){var m=this.getCoords_(j,i);this.currentPath_.push({type:"moveTo",x:m.x,y:m.y});this.currentX_=m.x;this.currentY_=m.y};l.lineTo=function(j,i){var m=this.getCoords_(j,i);this.currentPath_.push({type:"lineTo",x:m.x,y:m.y});this.currentX_=m.x;this.currentY_=m.y};l.bezierCurveTo=function(m,j,L,K,J,H){var i=this.getCoords_(J,H);var I=this.getCoords_(m,j);var G=this.getCoords_(L,K);p(this,I,G,i)};function p(i,G,m,j){i.currentPath_.push({type:"bezierCurveTo",cp1x:G.x,cp1y:G.y,cp2x:m.x,cp2y:m.y,x:j.x,y:j.y});i.currentX_=j.x;i.currentY_=j.y}l.quadraticCurveTo=function(J,m,j,i){var I=this.getCoords_(J,m);var H=this.getCoords_(j,i);var K={x:this.currentX_+2/3*(I.x-this.currentX_),y:this.currentY_+2/3*(I.y-this.currentY_)};var G={x:K.x+(H.x-this.currentX_)/3,y:K.y+(H.y-this.currentY_)/3};p(this,K,G,H)};l.arc=function(M,K,L,H,j,m){L*=a;var Q=m?"at":"wa";var N=M+E(H)*L-o;var P=K+s(H)*L-o;var i=M+E(j)*L-o;var O=K+s(j)*L-o;if(N==i&&!m){N+=0.125}var G=this.getCoords_(M,K);var J=this.getCoords_(N,P);var I=this.getCoords_(i,O);this.currentPath_.push({type:Q,x:G.x,y:G.y,radius:L,xStart:J.x,yStart:J.y,xEnd:I.x,yEnd:I.y})};l.rect=function(m,j,i,G){this.moveTo(m,j);this.lineTo(m+i,j);this.lineTo(m+i,j+G);this.lineTo(m,j+G);this.closePath()};l.strokeRect=function(m,j,i,G){var H=this.currentPath_;this.beginPath();this.moveTo(m,j);this.lineTo(m+i,j);this.lineTo(m+i,j+G);this.lineTo(m,j+G);this.closePath();this.stroke();this.currentPath_=H};l.fillRect=function(m,j,i,G){var H=this.currentPath_;this.beginPath();this.moveTo(m,j);this.lineTo(m+i,j);this.lineTo(m+i,j+G);this.lineTo(m,j+G);this.closePath();this.fill();this.currentPath_=H};l.createLinearGradient=function(j,G,i,m){var H=new A("gradient");H.x0_=j;H.y0_=G;H.x1_=i;H.y1_=m;return H};l.createRadialGradient=function(G,I,m,j,H,i){var J=new A("gradientradial");J.x0_=G;J.y0_=I;J.r0_=m;J.x1_=j;J.y1_=H;J.r1_=i;return J};l.drawImage=function(T,m){var M,K,O,ab,R,P,V,ad;var N=T.runtimeStyle.width;var S=T.runtimeStyle.height;T.runtimeStyle.width="auto";T.runtimeStyle.height="auto";var L=T.width;var Z=T.height;T.runtimeStyle.width=N;T.runtimeStyle.height=S;if(arguments.length==3){M=arguments[1];K=arguments[2];R=P=0;V=O=L;ad=ab=Z}else{if(arguments.length==5){M=arguments[1];K=arguments[2];O=arguments[3];ab=arguments[4];R=P=0;V=L;ad=Z}else{if(arguments.length==9){R=arguments[1];P=arguments[2];V=arguments[3];ad=arguments[4];M=arguments[5];K=arguments[6];O=arguments[7];ab=arguments[8]}else{throw Error("Invalid number of arguments")}}}var ac=this.getCoords_(M,K);var G=V/2;var j=ad/2;var aa=[];var i=10;var J=10;aa.push(" <g_vml_:group",' coordsize="',a*i,",",a*J,'"',' coordorigin="0,0"',' style="width:',i,"px;height:",J,"px;position:absolute;");if(this.m_[0][0]!=1||this.m_[0][1]){var I=[];I.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",w(ac.x/a),",","Dy=",w(ac.y/a),"");var Y=ac;var X=this.getCoords_(M+O,K);var U=this.getCoords_(M,K+ab);var Q=this.getCoords_(M+O,K+ab);Y.x=v.max(Y.x,X.x,U.x,Q.x);Y.y=v.max(Y.y,X.y,U.y,Q.y);aa.push("padding:0 ",w(Y.x/a),"px ",w(Y.y/a),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",I.join(""),", sizingmethod='clip');")}else{aa.push("top:",w(ac.y/a),"px;left:",w(ac.x/a),"px;")}aa.push(' ">','<g_vml_:image src="',T.src,'"',' style="width:',a*O,"px;"," height:",a*ab,'px;"',' cropleft="',R/L,'"',' croptop="',P/Z,'"',' cropright="',(L-R-V)/L,'"',' cropbottom="',(Z-P-ad)/Z,'"'," />","</g_vml_:group>");this.element_.insertAdjacentHTML("BeforeEnd",aa.join(""))};l.stroke=function(ag){var L=[];var M=false;var ar=c(ag?this.fillStyle:this.strokeStyle);var ac=ar.color;var am=ar.alpha*this.globalAlpha;var I=10;var O=10;L.push("<g_vml_:shape",' filled="',!!ag,'"',' style="position:absolute;width:',I,"px;height:",O,'px;"',' coordorigin="0 0" coordsize="',a*I," ",a*O,'"',' stroked="',!ag,'"',' path="');var N=false;var aq={x:null,y:null};var Y={x:null,y:null};for(var al=0;al<this.currentPath_.length;al++){var ak=this.currentPath_[al];var ap;switch(ak.type){case"moveTo":ap=ak;L.push(" m ",w(ak.x),",",w(ak.y));break;case"lineTo":L.push(" l ",w(ak.x),",",w(ak.y));break;case"close":L.push(" x ");ak=null;break;case"bezierCurveTo":L.push(" c ",w(ak.cp1x),",",w(ak.cp1y),",",w(ak.cp2x),",",w(ak.cp2y),",",w(ak.x),",",w(ak.y));break;case"at":case"wa":L.push(" ",ak.type," ",w(ak.x-this.arcScaleX_*ak.radius),",",w(ak.y-this.arcScaleY_*ak.radius)," ",w(ak.x+this.arcScaleX_*ak.radius),",",w(ak.y+this.arcScaleY_*ak.radius)," ",w(ak.xStart),",",w(ak.yStart)," ",w(ak.xEnd),",",w(ak.yEnd));break}if(ak){if(aq.x==null||ak.x<aq.x){aq.x=ak.x}if(Y.x==null||ak.x>Y.x){Y.x=ak.x}if(aq.y==null||ak.y<aq.y){aq.y=ak.y}if(Y.y==null||ak.y>Y.y){Y.y=ak.y}}}L.push(' ">');if(!ag){var X=this.lineScale_*this.lineWidth;if(X<1){am*=X}L.push("<g_vml_:stroke",' opacity="',am,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',t(this.lineCap),'"',' weight="',X,'px"',' color="',ac,'" />')}else{if(typeof this.fillStyle=="object"){var P=this.fillStyle;var U=0;var aj={x:0,y:0};var ad=0;var S=1;if(P.type_=="gradient"){var R=P.x0_/this.arcScaleX_;var m=P.y0_/this.arcScaleY_;var Q=P.x1_/this.arcScaleX_;var at=P.y1_/this.arcScaleY_;var ao=this.getCoords_(R,m);var an=this.getCoords_(Q,at);var K=an.x-ao.x;var J=an.y-ao.y;U=Math.atan2(K,J)*180/Math.PI;if(U<0){U+=360}if(U<0.000001){U=0}}else{var ao=this.getCoords_(P.x0_,P.y0_);var j=Y.x-aq.x;var G=Y.y-aq.y;aj={x:(ao.x-aq.x)/j,y:(ao.y-aq.y)/G};j/=this.arcScaleX_*a;G/=this.arcScaleY_*a;var ai=v.max(j,G);ad=2*P.r0_/ai;S=2*P.r1_/ai-ad}var ab=P.colors_;ab.sort(function(H,i){return H.offset-i.offset});var V=ab.length;var aa=ab[0].color;var Z=ab[V-1].color;var af=ab[0].alpha*this.globalAlpha;var ae=ab[V-1].alpha*this.globalAlpha;var ah=[];for(var al=0;al<V;al++){var T=ab[al];ah.push(T.offset*S+ad+" "+T.color)}L.push('<g_vml_:fill type="',P.type_,'"',' method="none" focus="100%"',' color="',aa,'"',' color2="',Z,'"',' colors="',ah.join(","),'"',' opacity="',ae,'"',' g_o_:opacity2="',af,'"',' angle="',U,'"',' focusposition="',aj.x,",",aj.y,'" />')}else{L.push('<g_vml_:fill color="',ac,'" opacity="',am,'" />')}}L.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",L.join(""))};l.fill=function(){this.stroke(true)};l.closePath=function(){this.currentPath_.push({type:"close"})};l.getCoords_=function(G,j){var i=this.m_;return{x:a*(G*i[0][0]+j*i[1][0]+i[2][0])-o,y:a*(G*i[0][1]+j*i[1][1]+i[2][1])-o}};l.save=function(){var i={};x(this,i);this.aStack_.push(i);this.mStack_.push(this.m_);this.m_=d(r(),this.m_)};l.restore=function(){x(this.aStack_.pop(),this);this.m_=this.mStack_.pop()};function g(i){for(var H=0;H<3;H++){for(var G=0;G<2;G++){if(!isFinite(i[H][G])||isNaN(i[H][G])){return false}}}return true}function B(j,i,G){if(!g(i)){return}j.m_=i;if(G){var H=i[0][0]*i[1][1]-i[0][1]*i[1][0];j.lineScale_=D(n(H))}}l.translate=function(m,j){var i=[[1,0,0],[0,1,0],[m,j,1]];B(this,d(i,this.m_),false)};l.rotate=function(j){var G=E(j);var m=s(j);var i=[[G,m,0],[-m,G,0],[0,0,1]];B(this,d(i,this.m_),false)};l.scale=function(m,j){this.arcScaleX_*=m;this.arcScaleY_*=j;var i=[[m,0,0],[0,j,0],[0,0,1]];B(this,d(i,this.m_),true)};l.transform=function(H,G,J,I,j,i){var m=[[H,G,0],[J,I,0],[j,i,1]];B(this,d(m,this.m_),true)};l.setTransform=function(I,H,K,J,G,j){var i=[[I,H,0],[K,J,0],[G,j,1]];B(this,i,true)};l.clip=function(){};l.arcTo=function(){};l.createPattern=function(){return new f};function A(i){this.type_=i;this.x0_=0;this.y0_=0;this.r0_=0;this.x1_=0;this.y1_=0;this.r1_=0;this.colors_=[]}A.prototype.addColorStop=function(j,i){i=c(i);this.colors_.push({offset:j,color:i.color,alpha:i.alpha})};function f(){}G_vmlCanvasManager=k;CanvasRenderingContext2D=q;CanvasGradient=A;CanvasPattern=f})()};
/*
 * html5slider - a JS implementation of <input type=range> for Firefox 4 and up
 *
 * Copyright (c) 2010-2011 Frank Yan, <http://frankyan.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE. 
*/
(function(){var m=document.createElement("input");try{m.type="range";if(m.type=="range"){return}}catch(k){return}if(!document.mozSetImageElement||!("MozAppearance" in m.style)){return}var g;var j=navigator.platform=="MacIntel";var a={radius:j?9:6,width:j?22:12,height:j?16:20};var d="-moz-linear-gradient(top, transparent "+(j?"6px, #999 6px, #999 7px, #ccc 9px, #bbb 11px, #bbb 12px, transparent 12px":"9px, #999 9px, #bbb 10px, #fff 11px, transparent 11px")+", transparent)";var n={"min-width":a.width+"px","min-height":a.height+"px","max-height":a.height+"px",padding:0,border:0,"border-radius":0,cursor:"default","text-indent":"-999999px"};var l=document.createEvent("HTMLEvents");l.initEvent("change",true,false);if(document.readyState=="loading"){document.addEventListener("DOMContentLoaded",h,true)}else{h()}function h(){Array.forEach(document.querySelectorAll("input[type=range]"),f);document.addEventListener("DOMNodeInserted",i,true)}function i(o){c(o.target);if(o.target.querySelectorAll){Array.forEach(o.target.querySelectorAll("input"),c)}}function c(e,o){if(e.localName!="input"||e.type=="range"){}else{if(e.getAttribute("type")=="range"){f(e)}else{if(!o){setTimeout(c,0,e,true)}}}}function f(D){var u,J,t,I,F,G,s;var E,H,w,B,C=D.value;if(!g){g=document.body.appendChild(document.createElement("hr"));b(g,{"-moz-appearance":j?"scale-horizontal":"scalethumb-horizontal",display:"block",visibility:"visible",opacity:1,position:"fixed",top:"-999999px"});document.mozSetImageElement("__sliderthumb__",g)}D.__defineGetter__("value",function(){return""+C});D.__defineSetter__("value",function(K){C=""+K;u=true;y()});D.__defineGetter__("type",function(){return"range"});["min","max","step"].forEach(function(K){if(D.hasAttribute(K)){J=true}D.__defineGetter__(K,function(){return this.hasAttribute(K)?this.getAttribute(K):""});D.__defineSetter__(K,function(L){L===null?this.removeAttribute(K):this.setAttribute(K,L)})});D.readOnly=true;b(D,n);x();D.addEventListener("DOMAttrModified",function(K){if(K.attrName=="value"&&!u){C=K.newValue;y()}else{if(~["min","max","step"].indexOf(K.attrName)){x();J=true}}},true);D.addEventListener("mousedown",v,true);D.addEventListener("keydown",p,true);D.addEventListener("focus",r,true);D.addEventListener("blur",z,true);function v(M){I=true;setTimeout(function(){I=false},0);if(M.button||!B){return}var L=parseFloat(getComputedStyle(this,0).width);var N=(L-a.width)/B;if(!N){return}var K=M.clientX-this.getBoundingClientRect().left-a.width/2-(C-E)*N;if(Math.abs(K)>a.radius){t=true;this.value-=-K/N}G=C;s=M.clientX;this.addEventListener("mousemove",A,true);this.addEventListener("mouseup",o,true)}function A(L){var K=parseFloat(getComputedStyle(this,0).width);var M=(K-a.width)/B;if(!M){return}G+=(L.clientX-s)/M;s=L.clientX;t=true;this.value=G}function o(){this.removeEventListener("mousemove",A,true);this.removeEventListener("mouseup",o,true)}function p(K){if(K.keyCode>36&&K.keyCode<41){r.call(this);t=true;this.value=C+(K.keyCode==38||K.keyCode==39?w:-w)}}function r(){if(!I){this.style.boxShadow=!j?"0 0 0 2px #fb0":"0 0 2px 1px -moz-mac-focusring, inset 0 0 1px -moz-mac-focusring"}}function z(){this.style.boxShadow=""}function q(K){return !isNaN(K)&&+K==parseFloat(K)}function x(){E=q(D.min)?+D.min:0;H=q(D.max)?+D.max:100;if(H<E){H=E>100?E:100}w=q(D.step)&&D.step>0?+D.step:1;B=H-E;y(true)}function e(){if(!u&&!J){C=D.getAttribute("value")}if(!q(C)){C=(E+H)/2}C=Math.round((C-E)/w)*w+E;if(C<E){C=E}else{if(C>H){C=E+~~(B/w)*w}}}function y(M){e();if(t&&C!=F){D.dispatchEvent(l)}t=false;if(!M&&C==F){return}F=C;var K=B?(C-E)/B*100:0;var L="-moz-element(#__sliderthumb__) "+K+"% no-repeat, ";b(D,{background:L+d})}}function b(e,o){for(var p in o){e.style.setProperty(p,o[p],"important")}}})();
/*
 * Ryan Johnson <http://syntacticx.com/>
 * Copyright 2008 PersonalGrid Corporation <http://personalgrid.com/>
 * LivePipe UI Components
 * MIT licensed
 * http://livepipe.net/
 */
/* core */
if(typeof(Control)=="undefined"){Control={}}var $proc=function(a){return typeof(a)=="function"?a:function(){return a}};var $value=function(a){return typeof(a)=="function"?a():a};Object.Event={extend:function(a){a._objectEventSetup=function(b){this._observers=this._observers||{};this._observers[b]=this._observers[b]||[]};a.observe=function(d,b){if(typeof(d)=="string"&&typeof(b)!="undefined"){this._objectEventSetup(d);if(!this._observers[d].include(b)){this._observers[d].push(b)}}else{for(var c in d){this.observe(c,d[c])}}};a.stopObserving=function(c,b){this._objectEventSetup(c);if(c&&b){this._observers[c]=this._observers[c].without(b)}else{if(c){this._observers[c]=[]}else{this._observers={}}}};a.observeOnce=function(d,c){var b=function(){c.apply(this,arguments);this.stopObserving(d,b)}.bind(this);this._objectEventSetup(d);this._observers[d].push(b)};a.notify=function(g){this._objectEventSetup(g);var d=[];var b=$A(arguments).slice(1);try{for(var c=0;c<this._observers[g].length;++c){d.push(this._observers[g][c].apply(this,b)||null)}}catch(f){if(f==$break){return false}else{throw f}}return d};if(a.prototype){a.prototype._objectEventSetup=a._objectEventSetup;a.prototype.observe=a.observe;a.prototype.stopObserving=a.stopObserving;a.prototype.observeOnce=a.observeOnce;a.prototype.notify=function(h){if(a.notify){var c=$A(arguments).slice(1);c.unshift(this);c.unshift(h);a.notify.apply(a,c)}this._objectEventSetup(h);var c=$A(arguments).slice(1);var f=[];try{if(this.options&&this.options[h]&&typeof(this.options[h])=="function"){f.push(this.options[h].apply(this,c)||null)}var b=this._observers[h];for(var d=0;d<b.length;++d){f.push(b[d].apply(this,c)||null)}}catch(g){if(g==$break){return false}else{throw g}}return f}}}};Element.addMethods({observeOnce:function(c,d,b){var a=function(){b.apply(this,arguments);Element.stopObserving(c,d,a)};Element.observe(c,d,a)}});(function(){function a(d){var e,c,b;if(d.wheelDelta){e=d.wheelDelta/120}else{if(d.detail){e=-d.detail/3}}if(!e){return}c=Event.extend(d).target;c=Element.extend(c.nodeType===Node.TEXT_NODE?c.parentNode:c);b=c.fire("mouse:wheel",{delta:e});if(b.stopped){Event.stop(d);return false}}document.observe("mousewheel",a);document.observe("DOMMouseScroll",a)})();var IframeShim=Class.create({initialize:function(){this.element=new Element("iframe",{style:"position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);display:none",src:"javascript:void(0);",frameborder:0});$(document.body).insert(this.element)},hide:function(){this.element.hide();return this},show:function(){this.element.show();return this},positionUnder:function(a){var a=$(a);var c=a.cumulativeOffset();var b=a.getDimensions();this.element.setStyle({left:c[0]+"px",top:c[1]+"px",width:b.width+"px",height:b.height+"px",zIndex:a.getStyle("zIndex")-1}).show();return this},setBounds:function(a){for(prop in a){a[prop]+="px"}this.element.setStyle(a);return this},destroy:function(){if(this.element){this.element.remove()}return this}});
/* hotkey */
if(typeof(Prototype)=="undefined"){throw"HotKey requires Prototype to be loaded."}if(typeof(Object.Event)=="undefined"){throw"HotKey requires Object.Event to be loaded."}var HotKey=Class.create({initialize:function(b,c,a){b=b.toUpperCase();HotKey.hotkeys.push(this);this.options=Object.extend({element:false,shiftKey:false,altKey:false,ctrlKey:true,bubbleEvent:true,fireOnce:false},a||{});this.letter=b;this.callback=function(d){if(!(this.options.fireOnce&&this.fired)&&Object.isFunction(c)){c(d)}if(!this.options.bubbleEvent){d.stop()}this.fired=true};this.element=$(this.options.element||document);this.handler=function(d){if(!d||((Event["KEY_"+this.letter]||this.letter.charCodeAt(0))==d.keyCode&&((!this.options.shiftKey||(this.options.shiftKey&&d.shiftKey))&&(!this.options.altKey||(this.options.altKey&&d.altKey))&&(!this.options.ctrlKey||(this.options.ctrlKey&&d.ctrlKey))))){if(this.notify("beforeCallback",d)===false){return}this.callback(d);this.notify("afterCallback",d)}}.bind(this);this.enable()},trigger:function(){this.handler()},enable:function(){this.element.observe("keydown",this.handler)},disable:function(){this.element.stopObserving("keydown",this.handler)},destroy:function(){this.disable();HotKey.hotkeys=HotKey.hotkeys.without(this)}});Object.extend(HotKey,{hotkeys:[]});Object.Event.extend(HotKey);
/* context menu */
if(typeof(Prototype)=="undefined"){throw"Control.ContextMenu requires Prototype to be loaded."}if(typeof(Object.Event)=="undefined"){throw"Control.ContextMenu requires Object.Event to be loaded."}Control.ContextMenu=Class.create({initialize:function(a,b){Control.ContextMenu.load();this.options=Object.extend({leftClick:false,disableOnShiftKey:true,disableOnAltKey:true,selectedClassName:"selected",activatedClassName:"activated",animation:true,animationCycles:2,animationLength:300,delayCallback:true},b||{});this.activated=false;this.items=this.options.items||[];this.container=$(a);this.container.observe(this.options.leftClick?"click":(Prototype.Browser.Opera?"click":"contextmenu"),function(c){if(!Control.ContextMenu.enabled||Prototype.Browser.Opera&&!c.ctrlKey){return}this.open(c)}.bindAsEventListener(this))},open:function(a){if(Control.ContextMenu.current&&!Control.ContextMenu.current.close()){return}if(this.notify("beforeOpen",a)===false){return false}this.buildMenu();if(this.items.length===0){this.close(a);return false}this.clicked=Event.element(a);Control.ContextMenu.current=this;Control.ContextMenu.positionContainer(a);Control.ContextMenu.container.show();if(this.notify("afterOpen",a)===false){return false}a.stop();return true},close:function(a){if(a){a.stop()}if(this.notify("beforeClose")===false){return false}Control.ContextMenu.current=false;this.activated=false;Control.ContextMenu.container.removeClassName(this.options.activatedClassName);Control.ContextMenu.container.select("li").invoke("stopObserving");Control.ContextMenu.container.hide();Control.ContextMenu.container.update("");if(this.notify("afterClose")===false){return false}return true},buildMenu:function(){var a=document.createElement("ul");Control.ContextMenu.container.appendChild(a);this.items.each(function(c){if(!(!c.condition||c.condition&&c.condition()!==false)){return}var b=$(document.createElement("li"));b.update($value(c.label));a.appendChild(b);b[$value(c.enabled)?"removeClassName":"addClassName"]("disabled");b.observe("mousedown",function(e,d){if(!$value(d.enabled)){return e.stop()}this.activated=$value(d.label)}.bindAsEventListener(this,c));b.observe("click",this.selectMenuItem.bindAsEventListener(this,c,b));b.observe("contextmenu",this.selectMenuItem.bindAsEventListener(this,c,b))}.bind(this))},addItem:function(a){if(!("enabled" in a)){a.enabled=true}this.items.push(a);return this},destroy:function(){this.container.stopObserving(Prototype.Browser.Opera||this.options.leftClick?"click":"contextmenu");this.items=[]},selectMenuItem:function(c,b,a){if(!$value(b.enabled)){return c.stop()}if(!this.activated||this.activated==$value(b.label)){if(this.options.animation){Control.ContextMenu.container.addClassName(this.options.activatedClassName);$A($R(0,this.options.animationCycles*2)).each(function(d){window.setTimeout(function(){a.toggleClassName(this.options.selectedClassName)}.bind(this),d*parseInt(this.options.animationLength/(this.options.animationCycles*2),10))}.bind(this));window.setTimeout(function(){if(this.close()&&this.options.delayCallback){b.callback(this.clicked)}}.bind(this),this.options.animationLength);if(!this.options.delayCallback){b.callback(this.clicked)}}else{if(this.close()){b.callback(this.clicked)}}}c.stop();return false}});Object.extend(Control.ContextMenu,{loaded:false,capture_all:false,menus:[],current:false,enabled:false,offset:4,load:function(a){if(Control.ContextMenu.loaded){return}Control.ContextMenu.loaded=true;if(typeof(a)=="undefined"){a=false}Control.ContextMenu.capture_all=a;Control.ContextMenu.container=$(document.createElement("div"));Control.ContextMenu.container.id="control_contextmenu";Control.ContextMenu.container.style.position="absolute";Control.ContextMenu.container.style.zIndex=99999;Control.ContextMenu.container.hide();document.body.appendChild(Control.ContextMenu.container);Control.ContextMenu.enable()},enable:function(){Control.ContextMenu.enabled=true;Event.observe(document.body,"click",Control.ContextMenu.onClick);if(Control.ContextMenu.capture_all){Event.observe(document.body,"contextmenu",Control.ContextMenu.onContextMenu)}},disable:function(){Event.stopObserving(document.body,"click",Control.ContextMenu.onClick);if(Control.ContextMenu.capture_all){Event.stopObserving(document.body,"contextmenu",Control.ContextMenu.onContextMenu)}},onContextMenu:function(a){a.stop();return false},onClick:function(){if(Control.ContextMenu.current){Control.ContextMenu.current.close()}},positionContainer:function(e){var d=Control.ContextMenu.container.getDimensions();var h=Event.pointerY(e);var g=Event.pointerX(e);var a=d.height+h;var b=d.width+g;var c=document.viewport.getDimensions();var f=document.viewport.getScrollOffsets();if(a>c.height+f.top){h-=a-((c.height+f.top)-Control.ContextMenu.offset)}if(b>c.width+f.left){g-=b-((c.width+f.left)-Control.ContextMenu.offset)}Control.ContextMenu.container.setStyle({top:h+"px",left:g+"px"})}});Object.Event.extend(Control.ContextMenu);
/* window */
if(typeof(Draggable)!="undefined"){Draggable.prototype.draw=function(j){var i=Position.cumulativeOffset(this.element);if(this.options.ghosting){var a=Position.realOffset(this.element);i[0]+=a[0]-Position.deltaX;i[1]+=a[1]-Position.deltaY}var h=this.currentDelta();i[0]-=h[0];i[1]-=h[1];if(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){i[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;i[1]-=this.options.scroll.scrollTop-this.originalScrollTop}var c=[0,1].map(function(d){return(j[d]-i[d]-this.offset[d])}.bind(this));if(this.options.snap){if(typeof this.options.snap=="function"){c=this.options.snap(c[0],c[1],this)}else{if(this.options.snap instanceof Array){c=c.map(function(d,m){return Math.round(d/this.options.snap[m])*this.options.snap[m]}.bind(this))}else{c=c.map(function(d){return Math.round(d/this.options.snap)*this.options.snap}.bind(this))}}}if(this.options.onDraw){this.options.onDraw.bind(this)(c)}else{var b=this.element.style;if(this.options.constrainToViewport){var l=document.viewport.getDimensions();var f=this.element.getDimensions();var g=parseInt(this.element.getStyle("margin-top"));var k=parseInt(this.element.getStyle("margin-left"));var e=[[0-k,0-g],[(l.width-f.width)-k,(l.height-f.height)-g]];if((!this.options.constraint)||(this.options.constraint=="horizontal")){if((c[0]>=e[0][0])&&(c[0]<=e[1][0])){this.element.style.left=c[0]+"px"}else{this.element.style.left=((c[0]<e[0][0])?e[0][0]:e[1][0])+"px"}}if((!this.options.constraint)||(this.options.constraint=="vertical")){if((c[1]>=e[0][1])&&(c[1]<=e[1][1])){this.element.style.top=c[1]+"px"}else{this.element.style.top=((c[1]<=e[0][1])?e[0][1]:e[1][1])+"px"}}}else{if((!this.options.constraint)||(this.options.constraint=="horizontal")){b.left=c[0]+"px"}if((!this.options.constraint)||(this.options.constraint=="vertical")){b.top=c[1]+"px"}}if(b.visibility=="hidden"){b.visibility=""}}}}if(typeof(Prototype)=="undefined"){throw"Control.Window requires Prototype to be loaded."}if(typeof(IframeShim)=="undefined"){throw"Control.Window requires IframeShim to be loaded."}if(typeof(Object.Event)=="undefined"){throw"Control.Window requires Object.Event to be loaded."}Control.Window=Class.create({initialize:function(b,c){Control.Window.windows.push(this);this.container=false;this.isOpen=false;this.href=false;this.sourceContainer=false;this.ajaxRequest=false;this.remoteContentLoaded=false;this.numberInSequence=Control.Window.windows.length+1;this.indicator=false;this.effects={fade:false,appear:false};this.indicatorEffects={fade:false,appear:false};this.options=Object.extend({beforeOpen:Prototype.emptyFunction,afterOpen:Prototype.emptyFunction,beforeClose:Prototype.emptyFunction,afterClose:Prototype.emptyFunction,height:null,width:null,className:false,position:"center",offsetLeft:0,offsetTop:0,iframe:false,hover:false,indicator:false,closeOnClick:false,iframeshim:true,fade:false,fadeDuration:0.75,draggable:false,onDrag:Prototype.emptyFunction,resizable:false,minHeight:false,minWidth:false,maxHeight:false,maxWidth:false,onResize:Prototype.emptyFunction,constrainToViewport:false,method:"post",parameters:{},onComplete:Prototype.emptyFunction,onSuccess:Prototype.emptyFunction,onFailure:Prototype.emptyFunction,onException:Prototype.emptyFunction,onRemoteContentLoaded:Prototype.emptyFunction,insertRemoteContentAt:false},c||{});this.indicator=this.options.indicator?$(this.options.indicator):false;if(b){if(typeof(b)=="string"&&b.match(Control.Window.uriRegex)){this.href=b}else{this.container=$(b);this.createDefaultContainer(b);if(this.container&&((this.container.readAttribute("href")&&this.container.readAttribute("href")!="")||(this.options.hover&&this.options.hover!==true))){if(this.options.hover&&this.options.hover!==true){this.sourceContainer=$(this.options.hover)}else{this.sourceContainer=this.container;this.href=this.container.readAttribute("href");var a=this.href.match(/^#(.+)$/);if(a&&a[1]){this.container=$(a[1]);this.href=false}else{this.container=false}}this.sourceContainerOpenHandler=function(e){this.open(e);e.stop();return false}.bindAsEventListener(this);this.sourceContainerCloseHandler=function(e){this.close(e)}.bindAsEventListener(this);this.sourceContainerMouseMoveHandler=function(e){this.position(e)}.bindAsEventListener(this);if(this.options.hover){this.sourceContainer.observe("mouseenter",this.sourceContainerOpenHandler);this.sourceContainer.observe("mouseleave",this.sourceContainerCloseHandler);if(this.options.position=="mouse"){this.sourceContainer.observe("mousemove",this.sourceContainerMouseMoveHandler)}}else{this.sourceContainer.observe("click",this.sourceContainerOpenHandler)}}}}this.createDefaultContainer(b);if(this.options.insertRemoteContentAt===false){this.options.insertRemoteContentAt=this.container}var d={margin:0,position:"absolute",zIndex:Control.Window.initialZIndexForWindow()};if(this.options.width){d.width=$value(this.options.width)+"px"}if(this.options.height){d.height=$value(this.options.height)+"px"}this.container.setStyle(d);if(this.options.className){this.container.addClassName(this.options.className)}this.positionHandler=this.position.bindAsEventListener(this);this.outOfBoundsPositionHandler=this.ensureInBounds.bindAsEventListener(this);this.bringToFrontHandler=this.bringToFront.bindAsEventListener(this);this.container.observe("mousedown",this.bringToFrontHandler);this.container.hide();this.closeHandler=this.close.bindAsEventListener(this);if(this.options.iframeshim){this.iFrameShim=new IframeShim();this.iFrameShim.hide()}this.applyResizable();this.applyDraggable();Event.observe(window,"resize",this.outOfBoundsPositionHandler);this.notify("afterInitialize")},open:function(c){if(this.isOpen){this.bringToFront();return false}if(this.notify("beforeOpen")===false){return false}if(this.options.closeOnClick){if(this.options.closeOnClick===true){this.closeOnClickContainer=$(document.body)}else{if(this.options.closeOnClick=="container"){this.closeOnClickContainer=this.container}else{if(this.options.closeOnClick=="overlay"){Control.Overlay.load();this.closeOnClickContainer=Control.Overlay.container}else{this.closeOnClickContainer=$(this.options.closeOnClick)}}}this.closeOnClickContainer.observe("click",this.closeHandler)}if(this.href&&!this.options.iframe&&!this.remoteContentLoaded){this.remoteContentLoaded=true;if(this.href.match(/\.(jpe?g|gif|png|tiff?)$/i)){var a=new Element("img");a.observe("load",function(d){this.getRemoteContentInsertionTarget().insert(d);this.position();if(this.notify("onRemoteContentLoaded")!==false){if(this.options.indicator){this.hideIndicator()}this.finishOpen()}}.bind(this,a));a.writeAttribute("src",this.href)}else{if(!this.ajaxRequest){if(this.options.indicator){this.showIndicator()}this.ajaxRequest=new Ajax.Request(this.href,{method:this.options.method,parameters:this.options.parameters,onComplete:function(d){this.notify("onComplete",d);this.ajaxRequest=false}.bind(this),onSuccess:function(d){this.getRemoteContentInsertionTarget().insert(d.responseText);this.notify("onSuccess",d);if(this.notify("onRemoteContentLoaded")!==false){if(this.options.indicator){this.hideIndicator()}this.finishOpen()}}.bind(this),onFailure:function(d){this.notify("onFailure",d);if(this.options.indicator){this.hideIndicator()}}.bind(this),onException:function(d,f){this.notify("onException",d,f);if(this.options.indicator){this.hideIndicator()}}.bind(this)})}}return true}else{if(this.options.iframe&&!this.remoteContentLoaded){this.remoteContentLoaded=true;if(this.options.indicator){this.showIndicator()}this.getRemoteContentInsertionTarget().insert(Control.Window.iframeTemplate.evaluate({href:this.href}));var b=this.container.down("iframe");b.onload=function(){this.notify("onRemoteContentLoaded");if(this.options.indicator){this.hideIndicator()}b.onload=null}.bind(this)}}this.finishOpen(c);return true},close:function(a){if(!this.isOpen||this.notify("beforeClose",a)===false){return false}if(this.options.closeOnClick){this.closeOnClickContainer.stopObserving("click",this.closeHandler)}if(this.options.fade){this.effects.fade=new Effect.Fade(this.container,{queue:{position:"front",scope:"Control.Window"+this.numberInSequence},from:1,to:0,duration:this.options.fadeDuration/2,afterFinish:function(){if(this.iFrameShim){this.iFrameShim.hide()}this.isOpen=false;this.notify("afterClose")}.bind(this)})}else{this.container.hide();if(this.iFrameShim){this.iFrameShim.hide()}}if(this.ajaxRequest){this.ajaxRequest.transport.abort()}if(!(this.options.draggable||this.options.resizable)&&this.options.position=="center"){Event.stopObserving(window,"resize",this.positionHandler)}if(!this.options.draggable&&this.options.position=="center"){Event.stopObserving(window,"scroll",this.positionHandler)}if(this.options.indicator){this.hideIndicator()}if(!this.options.fade){this.isOpen=false;this.notify("afterClose")}return true},position:function(d){if(this.options.position=="mouse"){var g=[Event.pointerX(d),Event.pointerY(d)];this.container.setStyle({top:g[1]+$value(this.options.offsetTop)+"px",left:g[0]+$value(this.options.offsetLeft)+"px"});return}var h=this.container.getDimensions();var c=document.viewport.getDimensions();Position.prepare();var b=(Position.deltaX+Math.floor((c.width-h.width)/2));var a=(Position.deltaY+((c.height>h.height)?Math.floor((c.height-h.height)/2):0));if(this.options.position=="center"||this.options.position=="center_once"){this.container.setStyle({top:(h.height<=c.height)?((a!=null&&a>0)?a:0)+"px":0,left:(h.width<=c.width)?((b!=null&&b>0)?b:0)+"px":0})}else{if(this.options.position=="relative"){var g=this.sourceContainer.cumulativeOffset();var f=g[1]+$value(this.options.offsetTop);var e=g[0]+$value(this.options.offsetLeft);this.container.setStyle({top:(h.height<=c.height)?(this.options.constrainToViewport?Math.max(0,Math.min(c.height-(h.height),f)):f)+"px":0,left:(h.width<=c.width)?(this.options.constrainToViewport?Math.max(0,Math.min(c.width-(h.width),e)):e)+"px":0})}else{if(this.options.position.length){var f=$value(this.options.position[1])+$value(this.options.offsetTop);var e=$value(this.options.position[0])+$value(this.options.offsetLeft);this.container.setStyle({top:(h.height<=c.height)?(this.options.constrainToViewport?Math.max(0,Math.min(c.height-(h.height),f)):f)+"px":0,left:(h.width<=c.width)?(this.options.constrainToViewport?Math.max(0,Math.min(c.width-(h.width),e)):e)+"px":0})}}}if(this.iFrameShim){this.updateIFrameShimZIndex()}},ensureInBounds:function(){if(!this.isOpen){return}var a=document.viewport.getDimensions();var c=this.container.cumulativeOffset();var b=this.container.getDimensions();if(c.left+b.width>a.width){this.container.setStyle({left:(Math.max(0,a.width-b.width))+"px"})}if(c.top+b.height>a.height){this.container.setStyle({top:(Math.max(0,a.height-b.height))+"px"})}},bringToFront:function(){Control.Window.bringToFront(this);this.notify("bringToFront")},destroy:function(){this.container.stopObserving("mousedown",this.bringToFrontHandler);if(this.draggable){Draggables.removeObserver(this.container);this.draggable.handle.stopObserving("mousedown",this.bringToFrontHandler);this.draggable.destroy()}if(this.resizable){Resizables.removeObserver(this.container);this.resizable.handle.stopObserving("mousedown",this.bringToFrontHandler);this.resizable.destroy()}if(this.container&&!this.sourceContainer){this.container.remove()}if(this.sourceContainer){if(this.options.hover){this.sourceContainer.stopObserving("mouseenter",this.sourceContainerOpenHandler);this.sourceContainer.stopObserving("mouseleave",this.sourceContainerCloseHandler);if(this.options.position=="mouse"){this.sourceContainer.stopObserving("mousemove",this.sourceContainerMouseMoveHandler)}}else{this.sourceContainer.stopObserving("click",this.sourceContainerOpenHandler)}}if(this.iFrameShim){this.iFrameShim.destroy()}Event.stopObserving(window,"resize",this.outOfBoundsPositionHandler);Control.Window.windows=Control.Window.windows.without(this);this.notify("afterDestroy")},applyResizable:function(){if(this.options.resizable){if(typeof(Resizable)=="undefined"){throw"Control.Window requires resizable.js to be loaded."}var a=null;if(this.options.resizable===true){a=new Element("div",{className:"resizable_handle"});this.container.insert(a)}else{a=$(this.options.resziable)}this.resizable=new Resizable(this.container,{handle:a,minHeight:this.options.minHeight,minWidth:this.options.minWidth,maxHeight:this.options.constrainToViewport?function(b){return(document.viewport.getDimensions().height-parseInt(b.style.top||0))-(b.getHeight()-parseInt(b.style.height||0))}:this.options.maxHeight,maxWidth:this.options.constrainToViewport?function(b){return(document.viewport.getDimensions().width-parseInt(b.style.left||0))-(b.getWidth()-parseInt(b.style.width||0))}:this.options.maxWidth});this.resizable.handle.observe("mousedown",this.bringToFrontHandler);Resizables.addObserver(new Control.Window.LayoutUpdateObserver(this,function(){if(this.iFrameShim){this.updateIFrameShimZIndex()}this.notify("onResize")}.bind(this)))}},applyDraggable:function(){if(this.options.draggable){if(typeof(Draggables)=="undefined"){throw"Control.Window requires dragdrop.js to be loaded."}var a=null;if(this.options.draggable===true){a=new Element("div",{className:"draggable_handle"});this.container.insert(a)}else{a=$(this.options.draggable)}this.draggable=new Draggable(this.container,{handle:a,constrainToViewport:this.options.constrainToViewport,zindex:this.container.getStyle("z-index"),starteffect:function(){if(Prototype.Browser.IE){this.old_onselectstart=document.onselectstart;document.onselectstart=function(){return false}}}.bind(this),endeffect:function(){document.onselectstart=this.old_onselectstart}.bind(this)});this.draggable.handle.observe("mousedown",this.bringToFrontHandler);Draggables.addObserver(new Control.Window.LayoutUpdateObserver(this,function(){if(this.iFrameShim){this.updateIFrameShimZIndex()}this.notify("onDrag")}.bind(this)))}},createDefaultContainer:function(a){if(!this.container){this.container=new Element("div",{id:"control_window_"+this.numberInSequence});$(document.body).insert(this.container);if(typeof(a)=="string"&&$(a)==null&&!a.match(/^#(.+)$/)&&!a.match(Control.Window.uriRegex)){this.container.update(a)}}},finishOpen:function(a){this.bringToFront();if(this.options.fade){if(typeof(Effect)=="undefined"){throw"Control.Window requires effects.js to be loaded."}if(this.effects.fade){this.effects.fade.cancel()}this.effects.appear=new Effect.Appear(this.container,{queue:{position:"end",scope:"Control.Window."+this.numberInSequence},from:0,to:1,duration:this.options.fadeDuration/2,afterFinish:function(){if(this.iFrameShim){this.updateIFrameShimZIndex()}this.isOpen=true;this.notify("afterOpen")}.bind(this)})}else{this.container.show()}this.position(a);if(!(this.options.draggable||this.options.resizable)&&this.options.position=="center"){Event.observe(window,"resize",this.positionHandler,false)}if(!this.options.draggable&&this.options.position=="center"){Event.observe(window,"scroll",this.positionHandler,false)}if(!this.options.fade){this.isOpen=true;this.notify("afterOpen")}return true},showIndicator:function(){this.showIndicatorTimeout=window.setTimeout(function(){if(this.options.fade){this.indicatorEffects.appear=new Effect.Appear(this.indicator,{queue:{position:"front",scope:"Control.Window.indicator."+this.numberInSequence},from:0,to:1,duration:this.options.fadeDuration/2})}else{this.indicator.show()}}.bind(this),Control.Window.indicatorTimeout)},hideIndicator:function(){if(this.showIndicatorTimeout){window.clearTimeout(this.showIndicatorTimeout)}this.indicator.hide()},getRemoteContentInsertionTarget:function(){return typeof(this.options.insertRemoteContentAt)=="string"?this.container.down(this.options.insertRemoteContentAt):$(this.options.insertRemoteContentAt)},updateIFrameShimZIndex:function(){if(this.iFrameShim){this.iFrameShim.positionUnder(this.container)}}});Object.extend(Control.Window,{windows:[],baseZIndex:9999,indicatorTimeout:250,iframeTemplate:new Template('<iframe src="#{href}" width="100%" height="100%" frameborder="0"></iframe>'),uriRegex:/^(\/|\#|https?\:\/\/|[\w]+\/)/,bringToFront:function(a){Control.Window.windows=Control.Window.windows.without(a);Control.Window.windows.push(a);Control.Window.windows.each(function(c,d){var b=Control.Window.baseZIndex+d;c.container.setStyle({zIndex:b});if(c.isOpen){if(c.iFrameShim){c.updateIFrameShimZIndex()}}if(c.options.draggable){c.draggable.options.zindex=b}})},open:function(b,c){var a=new Control.Window(b,c);a.open();return a},initialZIndexForWindow:function(a){return Control.Window.baseZIndex+(Control.Window.windows.length-1)}});Object.Event.extend(Control.Window);Control.Window.LayoutUpdateObserver=Class.create({initialize:function(a,b){this.w=a;this.element=$(a.container);this.observer=b},onStart:Prototype.emptyFunction,onEnd:function(b,a){if(a.element==this.element&&this.iFrameShim){this.w.updateIFrameShimZIndex()}},onResize:function(b,a){if(a.element==this.element){this.observer(this.element)}},onDrag:function(b,a){if(a.element==this.element){this.observer(this.element)}}});Control.Overlay={id:"control_overlay",loaded:false,container:false,lastOpacity:0,styles:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:9998},ieStyles:{position:"absolute",top:0,left:0,zIndex:9998},effects:{fade:false,appear:false},load:function(){if(Control.Overlay.loaded){return false}Control.Overlay.loaded=true;Control.Overlay.container=new Element("div",{id:Control.Overlay.id});$(document.body).insert(Control.Overlay.container);if(Prototype.Browser.IE){Control.Overlay.container.setStyle(Control.Overlay.ieStyles);Event.observe(window,"scroll",Control.Overlay.positionOverlay);Event.observe(window,"resize",Control.Overlay.positionOverlay);Control.Overlay.observe("beforeShow",Control.Overlay.positionOverlay)}else{Control.Overlay.container.setStyle(Control.Overlay.styles)}Control.Overlay.iFrameShim=new IframeShim();Control.Overlay.iFrameShim.hide();Event.observe(window,"resize",Control.Overlay.positionIFrameShim);Control.Overlay.container.hide();return true},unload:function(){if(!Control.Overlay.loaded){return false}Event.stopObserving(window,"resize",Control.Overlay.positionOverlay);Control.Overlay.stopObserving("beforeShow",Control.Overlay.positionOverlay);Event.stopObserving(window,"resize",Control.Overlay.positionIFrameShim);Control.Overlay.iFrameShim.destroy();Control.Overlay.container.remove();Control.Overlay.loaded=false;return true},show:function(a,b){if(Control.Overlay.notify("beforeShow")===false){return false}Control.Overlay.lastOpacity=a;Control.Overlay.positionIFrameShim();Control.Overlay.iFrameShim.show();if(b){if(typeof(Effect)=="undefined"){throw"Control.Window requires effects.js to be loaded."}if(Control.Overlay.effects.fade){Control.Overlay.effects.fade.cancel()}Control.Overlay.effects.appear=new Effect.Appear(Control.Overlay.container,{queue:{position:"end",scope:"Control.Overlay"},afterFinish:function(){Control.Overlay.notify("afterShow")},from:0,to:Control.Overlay.lastOpacity,duration:(b===true?0.75:b)/2})}else{Control.Overlay.container.setStyle({opacity:a||1});Control.Overlay.container.show();Control.Overlay.notify("afterShow")}return true},hide:function(a){if(Control.Overlay.notify("beforeHide")===false){return false}if(Control.Overlay.effects.appear){Control.Overlay.effects.appear.cancel()}Control.Overlay.iFrameShim.hide();if(a){Control.Overlay.effects.fade=new Effect.Fade(Control.Overlay.container,{queue:{position:"front",scope:"Control.Overlay"},afterFinish:function(){Control.Overlay.notify("afterHide")},from:Control.Overlay.lastOpacity,to:0,duration:(a===true?0.75:a)/2})}else{Control.Overlay.container.hide();Control.Overlay.notify("afterHide")}return true},positionIFrameShim:function(){if(Control.Overlay.container.visible()){Control.Overlay.iFrameShim.positionUnder(Control.Overlay.container)}},positionOverlay:function(){Control.Overlay.container.setStyle({width:document.body.clientWidth+"px",height:document.body.clientHeight+"px"})}};Object.Event.extend(Control.Overlay);Control.ToolTip=Class.create(Control.Window,{initialize:function($super,a,c,b){$super(c,Object.extend(Object.extend(Object.clone(Control.ToolTip.defaultOptions),b||{}),{position:"mouse",hover:a}))}});Object.extend(Control.ToolTip,{defaultOptions:{offsetLeft:10}});Control.Modal=Class.create(Control.Window,{initialize:function($super,a,b){Control.Modal.InstanceMethods.beforeInitialize.bind(this)();$super(a,Object.extend(Object.clone(Control.Modal.defaultOptions),b||{}))},closeWithoutOverlay:function(){this.keepOverlay=true;this.close()}});Object.extend(Control.Modal,{defaultOptions:{overlayOpacity:0.5,closeOnClick:"overlay"},current:false,open:function(a,b){var c=new Control.Modal(a,b);c.open();return c},close:function(){if(Control.Modal.current){Control.Modal.current.close()}},InstanceMethods:{beforeInitialize:function(){Control.Overlay.load();this.observe("beforeOpen",Control.Modal.Observers.beforeOpen.bind(this));this.observe("afterOpen",Control.Modal.Observers.afterOpen.bind(this));this.observe("afterClose",Control.Modal.Observers.afterClose.bind(this))}},Observers:{beforeOpen:function(){Control.Window.windows.without(this).each(function(a){if(a.closeWithoutOverlay&&a.isOpen){a.closeWithoutOverlay()}else{a.close()}});if(!Control.Overlay.overlayFinishedOpening){Control.Overlay.observeOnce("afterShow",function(){Control.Overlay.overlayFinishedOpening=true;this.open()}.bind(this));Control.Overlay.show(this.options.overlayOpacity,this.options.fade?this.options.fadeDuration:false);throw $break}},afterOpen:function(){Control.Overlay.show(this.options.overlayOpacity);Control.Overlay.overlayFinishedOpening=true;Control.Modal.current=this},afterClose:function(){if(!this.keepOverlay){Control.Overlay.hide(this.options.fade?this.options.fadeDuration:false);Control.Overlay.overlayFinishedOpening=false}this.keepOverlay=false;Control.Modal.current=false}}});Control.LightBox=Class.create(Control.Window,{initialize:function($super,a,b){this.allImagesLoaded=false;if(b.modal){var b=Object.extend(Object.clone(Control.LightBox.defaultOptions),b||{});b=Object.extend(Object.clone(Control.Modal.defaultOptions),b);b=Control.Modal.InstanceMethods.beforeInitialize.bind(this)(b);$super(a,b)}else{$super(a,Object.extend(Object.clone(Control.LightBox.defaultOptions),b||{}))}this.hasRemoteContent=this.href&&!this.options.iframe;if(this.hasRemoteContent){this.observe("onRemoteContentLoaded",Control.LightBox.Observers.onRemoteContentLoaded.bind(this))}else{this.applyImageObservers()}this.observe("beforeOpen",Control.LightBox.Observers.beforeOpen.bind(this))},applyImageObservers:function(){var a=this.getImages();this.numberImagesToLoad=a.length;this.numberofImagesLoaded=0;a.each(function(b){b.observe("load",function(c){++this.numberofImagesLoaded;if(this.numberImagesToLoad==this.numberofImagesLoaded){this.allImagesLoaded=true;this.onAllImagesLoaded()}}.bind(this,b));b.hide()}.bind(this))},onAllImagesLoaded:function(){this.getImages().each(function(a){this.showImage(a)}.bind(this));if(this.hasRemoteContent){if(this.options.indicator){this.hideIndicator()}this.finishOpen()}else{this.open()}},getImages:function(){return this.container.select(Control.LightBox.imageSelector)},showImage:function(a){a.show()}});Object.extend(Control.LightBox,{imageSelector:"img",defaultOptions:{},Observers:{beforeOpen:function(){if(!this.hasRemoteContent&&!this.allImagesLoaded){throw $break}},onRemoteContentLoaded:function(){this.applyImageObservers();if(!this.allImagesLoaded){throw $break}}}});
/* tabs */
if(typeof(Prototype)=="undefined"){throw"Control.Tabs requires Prototype to be loaded."}if(typeof(Object.Event)=="undefined"){throw"Control.Tabs requires Object.Event to be loaded."}Control.Tabs=Class.create({initialize:function(d,b){if(!$(d)){throw"Control.Tabs could not find the element: "+d}this.activeContainer=false;this.activeLink=false;this.containers=$H({});this.links=[];this.options={beforeChange:Prototype.emptyFunction,afterChange:Prototype.emptyFunction,hover:false,tracked:true,linkSelector:"li a",linkAttribute:"href",setClassOnContainer:false,activeClassName:"active",disabledClassName:"disabled",defaultTab:"first",autoLinkExternal:true,targetRegExp:/#(.+)$/,showFunction:Element.show,hideFunction:Element.hide};Object.extend(this.options,b||{});if(this.options.tracked){Control.Tabs.instances.push(this)}var c;switch(this.options.linkAttribute){case"href":case"src":c=function(e){return(/^#/).test(e.getAttribute(this.options.linkAttribute).replace(window.location.href.split("#")[0],""))};break;default:if(typeof(this.options.linkAttribute)=="function"){c=this.options.linkAttribute}else{c=function(e){return e.hasAttribute(this.options.linkAttribute)}}}(typeof(this.options.linkSelector)=="string"?$(d).select(this.options.linkSelector):this.options.linkSelector($(d))).findAll(c.bind(this)).each(function(e){this.addTab(e)}.bind(this));this.containers.values().each(Element.hide);if(this.options.defaultTab=="first"){this.setActiveTab(this.links.first())}else{if(this.options.defaultTab=="last"){this.setActiveTab(this.links.last())}else{this.setActiveTab(this.options.defaultTab)}}var a=this.options.targetRegExp.exec(window.location);if(a&&a[1]){a[1].split(",").each(function(e){this.setActiveTab(this.links.find(function(f){return f.key==e}))}.bind(this))}if(this.options.autoLinkExternal){$A(document.getElementsByTagName("a")).each(function(e){if(!this.links.include(e)){var f=e.href.replace(window.location.href.split("#")[0],"");if(f.substring(0,1)=="#"){if(this.containers.keys().include(f.substring(1))){$(e).observe("click",function(h,g){this.setActiveTab(g.substring(1))}.bindAsEventListener(this,f))}}}}.bind(this))}},addTab:function(b){this.links.push(b);switch(this.options.linkAttribute){case"href":case"src":b.key=b.getAttribute(this.options.linkAttribute).replace(window.location.href.split("#")[0],"").split("#").last().replace(/#/,"");break;default:if(typeof(this.options.linkAttribute)=="function"){b.key=this.options.linkAttribute(b)}else{b.key=b.getAttribute(this.options.linkAttribute)}}var a=this.options.tabs_container?this.options.tabs_container.down("#"+b.key):$(b.key);if(!a){throw"Control.Tabs: #"+b.key+" was not found on the page."}this.containers.set(b.key,a);b[this.options.hover?"onmouseover":"onclick"]=function(c){if(window.event){Event.stop(window.event)}this.setActiveTab(c);return false}.bind(this,b)},getTab:function(a){if(!a&&typeof(a)=="undefined"){return null}if(typeof(a)=="string"){return this.getTab(this.links.find(function(b){return b.key==a}))}else{if(typeof(a)=="number"){return this.getTab(this.links[a])}else{return this.containers.get(a.key)}}},setActiveTab:function(a){if(!a&&typeof(a)=="undefined"){return}if(typeof(a)=="string"){this.setActiveTab(this.links.find(function(b){return b.key==a}))}else{if(typeof(a)=="number"){this.setActiveTab(this.links[a])}else{if(!(this.options.setClassOnContainer?$(a.parentNode):a).hasClassName(this.options.disabledClassName)){if(a==this.activeLink){return}if(this.notify("beforeChange",this.activeContainer,this.containers.get(a.key))===false){return}if(this.activeContainer){this.options.hideFunction(this.activeContainer)}this.links.each(function(b){(this.options.setClassOnContainer?$(b.parentNode):b).removeClassName(this.options.activeClassName)}.bind(this));(this.options.setClassOnContainer?$(a.parentNode):a).addClassName(this.options.activeClassName);this.activeContainer=this.containers.get(a.key);this.activeLink=a;this.options.showFunction(this.containers.get(a.key));this.notify("afterChange",this.containers.get(a.key))}}}},disableTab:function(a){if(!a&&typeof(a)=="undefined"){return}if(typeof(a)=="string"){this.disableTab(this.links.find(function(b){return b.key==a}))}else{if(typeof(a)=="number"){this.disableTab(this.links[a])}else{if({INPUT:true,BUTTON:true,SELECT:true,TEXTAREA:true}[a.nodeName]){a.disabled=true}(this.options.setClassOnContainer?$(a.parentNode):a).addClassName(this.options.disabledClassName)}}},enableTab:function(a){if(!a&&typeof(a)=="undefined"){return}if(typeof(a)=="string"){this.enableTab(this.links.find(function(b){return b.key==a}))}else{if(typeof(a)=="number"){this.enableTab(this.links[a])}else{if({INPUT:true,BUTTON:true,SELECT:true,TEXTAREA:true}[a.nodeName]){a.disabled=false}(this.options.setClassOnContainer?$(a.parentNode):a).removeClassName(this.options.disabledClassName)}}},next:function(){this.links.each(function(b,a){if(this.activeLink==b&&this.links[a+1]){this.setActiveTab(this.links[a+1]);throw $break}}.bind(this))},previous:function(){this.links.each(function(b,a){if(this.activeLink==b&&this.links[a-1]){this.setActiveTab(this.links[a-1]);throw $break}}.bind(this))},first:function(){this.setActiveTab(this.links.first())},last:function(){this.setActiveTab(this.links.last())}});Object.extend(Control.Tabs,{instances:[],findByTabId:function(a){return Control.Tabs.instances.find(function(b){return b.links.find(function(c){return c.key==a})})}});Object.Event.extend(Control.Tabs);
/* progress bar */
if(typeof(Prototype)=="undefined"){throw"Control.ProgressBar requires Prototype to be loaded."}if(typeof(Object.Event)=="undefined"){throw"Control.ProgressBar requires Object.Event to be loaded."}Control.ProgressBar=Class.create({initialize:function(a,b){this.progress=0;this.executer=false;this.active=false;this.poller=false;this.container=$(a);this.containerWidth=this.container.getDimensions().width-(parseInt(this.container.getStyle("border-right-width").replace(/px/,""),10)+parseInt(this.container.getStyle("border-left-width").replace(/px/,""),10));this.progressContainer=$(document.createElement("div"));this.progressContainer.setStyle({width:this.containerWidth+"px",height:"100%",position:"absolute",top:"0px",right:"0px"});this.container.appendChild(this.progressContainer);this.options={afterChange:Prototype.emptyFunction,interval:0.25,step:1,classNames:{active:"progress_bar_active",inactive:"progress_bar_inactive"}};Object.extend(this.options,b||{});this.container.addClassName(this.options.classNames.inactive);this.active=false},setProgress:function(a){this.progress=a;this.draw();if(this.progress>=100){this.stop(false)}this.notify("afterChange",this.progress,this.active)},poll:function(c,b,a){a=a||{};var d=a.onSuccess||Prototype.emptyFunction;a.onSuccess=d.wrap(function(e,f){this.setProgress(parseInt(f.responseText,10));if(!this.active){this.poller.stop()}e(f)}).bind(this);this.active=true;this.poller=new PeriodicalExecuter(function(){var e=new Ajax.Request(c,a)}.bind(this),b||3)},start:function(){this.active=true;this.container.removeClassName(this.options.classNames.inactive);this.container.addClassName(this.options.classNames.active);this.executer=new PeriodicalExecuter(this.step.bind(this,this.options.step),this.options.interval)},stop:function(a){this.active=false;if(this.executer){this.executer.stop()}this.container.removeClassName(this.options.classNames.active);this.container.addClassName(this.options.classNames.inactive);if(typeof a==="undefined"||a===true){this.reset()}},step:function(a){this.active=true;this.setProgress(Math.min(100,this.progress+a))},reset:function(){this.active=false;this.setProgress(0)},draw:function(){this.progressContainer.setStyle({width:(this.containerWidth-Math.floor((parseInt(this.progress,10)/100)*this.containerWidth))+"px"})},notify:function(a){if(this.options[a]){return[this.options[a].apply(this.options[a],$A(arguments).slice(1))]}}});Object.Event.extend(Control.ProgressBar);
/* scroll bar */
if(typeof(Prototype)=="undefined"){throw"Control.ScrollBar requires Prototype to be loaded."}if(typeof(Control.Slider)=="undefined"){throw"Control.ScrollBar requires Control.Slider to be loaded."}if(typeof(Object.Event)=="undefined"){throw"Control.ScrollBar requires Object.Event to be loaded."}Control.ScrollBar=Class.create({initialize:function(b,a,c){Control.ScrollBar.instances.push(this);this.enabled=false;this.notificationTimeout=false;this.container=$(b);this.boundMouseWheelEvent=this.onMouseWheel.bindAsEventListener(this);this.boundResizeObserver=this.onWindowResize.bind(this);this.track=$(a);this.handle=this.track.firstDescendant();this.options=Object.extend({active_class_name:"scrolling",apply_active_class_name_to:this.container,notification_timeout_length:125,handle_minimum_length:25,scroll_to_smoothing:0.01,scroll_to_steps:15,scroll_to_precision:100,proportional:true,custom_event:null,custom_event_handler:null,scroll_axis:"vertical",fixed_scroll_distance:-1,slider_options:{}},c||{});this.slider=new Control.Slider(this.handle,this.track,Object.extend({axis:this.options.scroll_axis,onSlide:this.onChange.bind(this),onChange:this.onChange.bind(this)},this.options.slider_options));this.recalculateLayout();Event.observe(window,"resize",this.boundResizeObserver);if(this.options.custom_event){if(Object.isFunction(this.options.custom_event_handler)){this.container.observe(this.options.custom_event,this.options.custom_event_handler)}else{this.container.observe(this.options.custom_event,this.boundResizeObserver)}}this.handle.observe("mousedown",function(){if(this.auto_sliding_executer){this.auto_sliding_executer.stop()}}.bind(this))},destroy:function(){Event.stopObserving(window,"resize",this.boundResizeObserver);if(this.options.active_class_name){$(this.options.apply_active_class_name_to).removeClassName(this.options.active_class_name)}if(this.options.custom_event){this.container.stopObserving(this.options.custom_event)}},scrollLength:function(){return(this.options.scroll_axis=="vertical")?this.container.scrollHeight:this.container.scrollWidth},offsetLength:function(){return(this.options.scroll_axis=="vertical")?this.container.offsetHeight:this.container.offsetWidth},enable:function(){this.enabled=true;this.container.observe("mouse:wheel",this.boundMouseWheelEvent);this.slider.setEnabled();this.track.show();if(this.options.active_class_name){$(this.options.apply_active_class_name_to).addClassName(this.options.active_class_name)}this.notify("enabled")},disable:function(){this.enabled=false;this.container.stopObserving("mouse:wheel",this.boundMouseWheelEvent);this.slider.setDisabled();this.track.hide();if(this.options.active_class_name){$(this.options.apply_active_class_name_to).removeClassName(this.options.active_class_name)}this.notify("disabled");this.reset()},reset:function(){this.slider.setValue(0)},recalculateLayout:function(){if(this.scrollLength()<=this.offsetLength()){this.disable()}else{this.enable();this.slider.trackLength=this.slider.maximumOffset()-this.slider.minimumOffset();if(this.options.proportional){this.slider.handleLength=Math.max(this.offsetLength()*(this.offsetLength()/this.scrollLength()),this.options.handle_minimum_length);if(this.options.scroll_axis=="vertical"){this.handle.style.height=this.slider.handleLength+"px"}else{this.handle.style.width=this.slider.handleLength+"px"}}this.scrollBy(0)}},onWindowResize:function(){this.recalculateLayout();this.scrollBy(0)},onMouseWheel:function(a){if(this.auto_sliding_executer){this.auto_sliding_executer.stop()}if(this.options.fixed_scroll_distance>0){this.slider.setValueBy(-(this.options.fixed_scroll_distance*a.memo.delta/(this.scrollLength()-this.slider.trackLength)))}else{this.slider.setValueBy(-(a.memo.delta/20))}a.stop();return false},onChange:function(b){var a=Math.round(b/this.slider.maximum*(this.scrollLength()-this.offsetLength()));if(this.options.scroll_axis=="vertical"){this.container.scrollTop=a}else{this.container.scrollLeft=a}if(this.notification_timeout){window.clearTimeout(this.notificationTimeout)}this.notificationTimeout=window.setTimeout(function(){this.notify("change",b)}.bind(this),this.options.notification_timeout_length)},getCurrentMaximumDelta:function(){return this.slider.maximum*(this.scrollLength()-this.offsetLength())},getContainerOffset:function(a){var b=a.positionedOffset();while(a.getOffsetParent()!=this.container){a=a.getOffsetParent();b[0]+=a.positionedOffset()[0];b[1]+=a.positionedOffset()[1];b.top+=a.positionedOffset().top;b.left+=a.positionedOffset().left}return b},getDeltaToElement:function(a){if(this.options.scroll_axis=="vertical"){return this.slider.maximum*((this.getContainerOffset(a).top+(a.getHeight()/2))-(this.container.getHeight()/2))}else{return this.slider.maximum*((this.getContainerOffset(a).left+(a.getWidth()/2))-(this.container.getWidth()/2))}},scrollTo:function(g,b){var a=this.options.scroll_to_precision,d=this.getCurrentMaximumDelta();if(a=="auto"){a=Math.pow(10,Math.ceil(Math.log(d)/Math.log(10)))}if(g=="top"){g=0}else{if(g=="bottom"){g=d}else{if(typeof(g)!="number"){g=this.getDeltaToElement($(g))}}}if(this.enabled){g=Math.max(0,Math.min(g,d));if(this.auto_sliding_executer){this.auto_sliding_executer.stop()}var c=g/d;var f=this.slider.value;var e=(c-f)*d;if(b){this.auto_sliding_executer=new PeriodicalExecuter(function(){if(Math.round(this.slider.value*a)/a<Math.round(c*a)/a||Math.round(this.slider.value*a)/a>Math.round(c*a)/a){this.scrollBy(e/this.options.scroll_to_steps)}else{this.auto_sliding_executer.stop();this.auto_sliding_executer=null;if(typeof(b)=="function"){b()}}}.bind(this),this.options.scroll_to_smoothing)}else{this.scrollBy(e)}}else{if(typeof(b)=="function"){b()}}},scrollBy:function(a){if(!this.enabled){return false}this.slider.setValueBy(a/(this.getCurrentMaximumDelta()==0?1:this.getCurrentMaximumDelta()))}});Object.extend(Control.ScrollBar,{instances:[],findByElementId:function(a){return Control.ScrollBar.instances.find(function(b){return(b.container.id&&b.container.id==a)})}});Object.Event.extend(Control.ScrollBar);
